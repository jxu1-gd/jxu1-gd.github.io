{"version":3,"file":"static/js/401.d340af60.chunk.js","mappings":"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","sources":["ChatModule.js"],"sourcesContent":["import cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport ChooseOptionWindow from './components/choose-option-window/ChooseOptionWindow';\nimport GenericMessage from './components/generic-message/GenericMessage';\nimport Hoop from './components/hoop/Hoop';\nimport ChatService from './service/ChatService';\nimport './styles/chat-module.scss';\nimport CssImport from './util/CssImport';\nimport GatewayHttpClient from './util/GatewayHttpClient';\n\nclass ChatModule extends PureComponent {\n    static propTypes = {\n        contextCls: PropTypes.string,\n        containerElement: PropTypes.object,\n        accountIdentifier: PropTypes.string,\n        accessToken: PropTypes.string,\n        email: PropTypes.string,\n        brand: PropTypes.string,\n        env: PropTypes.string,\n    };\n\n    state = {\n        shouldShowChooseOptionWindow: false,\n        shouldShowErrorPage: false,\n        shouldShowHoopWindow: false,\n    };\n\n    render() {\n        const { isDesignTokenApplied } = this.state;\n\n        return isDesignTokenApplied && this.renderContent();\n    }\n\n    componentDidMount() {\n        const { accessToken } = this.props;\n\n        if (accessToken) {\n            GatewayHttpClient.accessToken = accessToken;\n        }\n\n        this.setContainerElementStyle();\n        this.fetchConfig();\n        this.applyDesignToken();\n    }\n\n    componentWillUnmount() {\n        this.restoreContainerElementStyle();\n    }\n\n    renderContent() {\n        const {\n            shouldShowChooseOptionWindow,\n            shouldShowErrorPage,\n            shouldShowHoopWindow,\n            shouldShowMinimizedIconButton,\n        } = this.state;\n\n        return (\n            <>\n                {shouldShowMinimizedIconButton && this.renderIconButtonChat()}\n                {shouldShowChooseOptionWindow &&\n                    this.renderChooseOptionWindow()}\n                {shouldShowHoopWindow && this.renderHoopWindow()}\n                {shouldShowErrorPage && this.renderErrorPage()}\n            </>\n        );\n    }\n\n    renderHoopWindow = () => {\n        const { contextCls, ...restProps } = this.props;\n        const { chatConfigs } = this.state;\n\n        return (\n            <Hoop\n                contextCls={cx(this.baseCls, contextCls)}\n                hoop={chatConfigs.hoop}\n                isLeaveAgentMessageEnabled={\n                    chatConfigs.isLeaveAgentMessageEnabled\n                }\n                {...restProps}\n                {...chatConfigs}\n            />\n        );\n    };\n\n    renderChooseOptionWindow = () => {\n        const { contextCls, ...restProps } = this.props;\n        const { chatConfigs } = this.state;\n\n        return (\n            <ChooseOptionWindow\n                contextCls={cx(this.baseCls, contextCls)}\n                ewt={chatConfigs.ewt}\n                {...restProps}\n                {...chatConfigs}\n            />\n        );\n    };\n\n    renderErrorPage = () => {\n        const { contextCls, ...restProps } = this.props;\n\n        return (\n            <GenericMessage\n                contextCls={cx(this.baseCls, contextCls)}\n                icon=\"WarningAlert\"\n                windowTitle=\"Chat with an agent\"\n                headText=\"There was a problem connecting to chat support\"\n                subText=\"Please try again later.\"\n                {...restProps}\n            />\n        );\n    };\n\n    async fetchConfig() {\n        const newState = {};\n\n        try {\n            const chatConfig = await ChatService.getChatConfig();\n            const { isAgentOnline, isSuccess, errors, ...restConfig } =\n                chatConfig;\n            newState.chatConfigs = restConfig;\n\n            if (isAgentOnline) {\n                newState.shouldShowChooseOptionWindow = true;\n            } else {\n                newState.shouldShowHoopWindow = true;\n            }\n\n            if (!isSuccess) {\n                newState.shouldShowErrorPage = true;\n            }\n        } catch (e) {\n            newState.shouldShowErrorPage = true;\n        } finally {\n            this.setState(newState);\n        }\n    }\n\n    async applyDesignToken() {\n        try {\n            const { brand } = this.props;\n            await CssImport.import(brand);\n            this.setState({\n                isDesignTokenApplied: true,\n            });\n        } catch (e) {\n            console.debug(e.message);\n        }\n    }\n\n    setContainerElementStyle() {\n        const { containerElement } = this.props;\n\n        if (containerElement) {\n            this.setState({\n                originContainerElementPosition: containerElement.style.position,\n            });\n            containerElement.style.position = 'relative';\n        }\n    }\n\n    restoreContainerElementStyle() {\n        const { containerElement } = this.props;\n        const { originContainerElementPosition } = this.state;\n\n        if (containerElement && originContainerElementPosition) {\n            containerElement.style.position = originContainerElementPosition;\n        }\n    }\n\n    baseCls = 'web-chat-module';\n}\n\nexport default ChatModule;\n"],"names":["ChatModule","state","shouldShowChooseOptionWindow","shouldShowErrorPage","shouldShowHoopWindow","renderHoopWindow","props","contextCls","restProps","chatConfigs","cx","baseCls","hoop","isLeaveAgentMessageEnabled","renderChooseOptionWindow","ewt","renderErrorPage","icon","windowTitle","headText","subText","this","isDesignTokenApplied","renderContent","accessToken","GatewayHttpClient","setContainerElementStyle","fetchConfig","applyDesignToken","restoreContainerElementStyle","shouldShowMinimizedIconButton","renderIconButtonChat","newState","ChatService","chatConfig","isAgentOnline","isSuccess","errors","restConfig","setState","brand","CssImport","console","debug","message","containerElement","originContainerElementPosition","style","position","PureComponent"],"sourceRoot":""}